<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>{{veiculo.marca}} {{veiculo.modelo}} - Detalhes</title>
		<link
			rel="stylesheet"
			href="/ProjetoTurmaB-Consessionaria/public/assets/css/style.css" />
		<!-- favor colocar o css dentro do style.css -->
	</head>
	<body>
		<h1>Detalhes do Veículo</h1>
		<!-- modelo da barra de pesquisa (necessária de ser colocada em algumas páginas pra gente poder pesquisar, igual no mercado livre por exemplo)-->
		<form action="/ProjetoTurmaB-Consessionaria/veiculos/pesquisar" method="GET">
			<input
				type="text"
				name="q"
				id="barraPesquisa"
				placeholder="Pesquisar marca, modelo, cor..." />
			<button>Pesquisar</button>
			{% if pesquisa is defined %}
			<p>Resultados para: "{{ pesquisa }}"</p>
			{% endif %} {% if pesquisa is defined and veiculos is empty %}
			<p id="pesquisaNaoEncontrada">Nenhum veículo encontrado.</p>
			{% endif %}
		</form>
		<!-- fim do modelo -->

		{% if galeria is not empty %}
		<div
			class="galeria"
			id="galeria"
			data-imagens="{% for img in galeria %}{{ img }}{% if not loop.last %},{% endif %}{% endfor %}">
			<button class="setaDetalhes" onclick="anterior()">&lt;</button>
			<img
				id="foto"
				src="/ProjetoTurmaB-Consessionaria/public/assets/img/galeriaImagens/{{ galeria[0] }}"
				alt="{{ veiculo.modelo }}" />
			<button class="setaDetalhes" onclick="proximo()">&gt;</button>
		</div>

		<script>
			// pega o atributo data-imagens e transforma em array
			let galeriaDiv = document.getElementById("galeria");
			let imagens = galeriaDiv.dataset.imagens.split(",");
			let i = 0;

			function atualizar() {
				document.getElementById("foto").src =
					"/ProjetoTurmaB-Consessionaria/public/assets/img/galeriaImagens/" + imagens[i];
			}

			function anterior() {
				i--;
				if (i < 0) i = imagens.length - 1;
				atualizar();
			}

			function proximo() {
				i++;
				if (i >= imagens.length) i = 0;
				atualizar();
			}
		</script>
		{% else %}
		<img
			src="/ProjetoTurmaB-Consessionaria/public/assets/img/{{ veiculo.imagem }}"
			alt="{{ veiculo.modelo }}"
			id="foto" />
		{% endif %}
		<h2>{{ veiculo.marca }} {{ veiculo.modelo }} {{ veiculo.ano }}</h2>
		<p>{{ veiculo.cor }}</p>
		<p>Descrição do veículo:</p>
		<p>{{ veiculo.descricao }}</p>
		<p>Quilometragem: {{ veiculo.quilometragem }} km</p>
		<p>Valor: R${{ veiculo.preco }}</p>
		<a href=""><button>Fazer Proposta (em breve)</button></a>
	</body>
</html>
